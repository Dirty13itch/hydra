{
  "id": "a227ebd1",
  "type": "pattern",
  "title": "TabbyAPI Speculative Decoding Configuration Pattern",
  "description": "Proper configuration for speculative decoding in TabbyAPI requires: 1) draft_model section with draft_model_dir and draft_model_name, 2) Same model family for main and draft (e.g., Llama 3.1 family), 3) Q4 cache mode for both models, 4) VRAM budget: main model + draft model + 2x cache size + 4GB overhead.",
  "created_at": "2025-12-16T20:47:49.961424Z",
  "tags": [
    "speculative-decoding",
    "exllamav2",
    "tabbyapi",
    "pattern",
    "inference"
  ],
  "solution": "For 56GB VRAM (5090+4090): Use 3.5bpw or 2.5bpw main model with 8B 6.0bpw draft. Reduce context to 8k if needed. Config: draft_model: {draft_model_dir: /mnt/models, draft_model_name: Llama-3.1-8B-Instruct-exl2-6.0bpw, draft_cache_mode: Q4}",
  "embedding": [
    -0.049087755,
    0.05693411,
    -0.1587243,
    -0.047018785,
    0.06311468,
    -0.08563785,
    -0.0021628605,
    -0.006991287,
    -0.059245054,
    -0.017011337,
    0.0013421465,
    0.032670736,
    0.053548384,
    0.028797116,
    -0.0010020239,
    0.045879975,
    0.0098236855,
    -0.014667124,
    0.027711984,
    0.016933179,
    0.0013273436,
    -0.0060103307,
    -0.04818619,
    -0.023417199,
    0.06398322,
    0.030825479,
    -0.040310014,
    0.019175287,
    -0.021095503,
    -0.014779732,
    0.06177639,
    -0.022850337,
    -0.017509045,
    -0.027371665,
    -0.086282134,
    -0.066267826,
    0.051430892,
    -0.015193361,
    -0.036329437,
    0.044306535,
    0.025283502,
    0.020764649,
    0.016716711,
    -0.036410082,
    0.018601699,
    0.017138986,
    0.07716678,
    -0.019834012,
    0.05180126,
    -0.10679491,
    0.05689244,
    -0.0053309393,
    0.05234484,
    -0.032393258,
    0.018426478,
    0.069900155,
    -0.0010523528,
    0.05476216,
    0.011403365,
    -0.04756708,
    0.06545745,
    -0.009945741,
    -0.04452308,
    0.07702614,
    0.003510712,
    0.017598271,
    -0.046543274,
    0.046928838,
    -0.0022956696,
    -0.05580905,
    0.058822736,
    0.0132432915,
    -0.043007504,
    0.007121382,
    -0.02825612,
    0.029520987,
    -0.04492742,
    -0.019178031,
    -0.05735284,
    0.06866032,
    0.008364388,
    -0.013411251,
    0.05997118,
    -0.014637146,
    0.016560687,
    0.018059887,
    -0.06085809,
    0.028682604,
    -0.061195385,
    0.025991844,
    -0.028042125,
    -0.025010422,
    0.015656888,
    -0.0015386583,
    -0.028865518,
    0.061018948,
    -0.013833482,
    0.04094554,
    -0.045378394,
    -0.016119052,
    0.001622642,
    0.0559598,
    0.028023353,
    -0.022768939,
    -0.0030953996,
    0.018938605,
    -0.08307945,
    -0.039671224,
    -0.009934728,
    -0.0010965961,
    -0.02918365,
    0.015723031,
    0.00018550336,
    -0.03393847,
    0.012294985,
    -0.051644135,
    0.020420305,
    0.014372268,
    0.011614338,
    0.020244759,
    -0.045627188,
    -0.021161478,
    0.023993433,
    0.021850908,
    0.023080995,
    0.044828888,
    -0.05635172,
    0.033021957,
    -0.012602206,
    -0.09418949,
    0.044524807,
    -0.033096522,
    -0.04848923,
    0.047359977,
    0.011824241,
    0.01807299,
    -0.022262245,
    -0.0032795267,
    0.0139977075,
    -0.0035772808,
    0.023658438,
    0.01454796,
    -0.020108549,
    -0.048803136,
    -0.0036774573,
    -0.08921809,
    0.0061478214,
    -0.032431692,
    -0.018438106,
    -0.008100994,
    -0.012895195,
    0.04568251,
    0.013918684,
    0.00990513,
    0.017104967,
    -0.008807879,
    0.05977665,
    -0.0026491538,
    0.025765289,
    0.036123212,
    0.023540517,
    0.0024055387,
    -0.025530722,
    0.070246674,
    -0.05880827,
    -0.035007514,
    0.053751845,
    0.026081547,
    0.026967352,
    0.041804206,
    -0.05364905,
    -0.04721212,
    -0.001997252,
    -0.017194103,
    0.03723706,
    0.01395235,
    0.031447537,
    -0.0019373962,
    0.020679552,
    -0.0061201435,
    -0.013840856,
    -0.011179786,
    0.027470112,
    0.0016091822,
    -0.062378425,
    0.01034418,
    0.006343118,
    0.00078974804,
    0.0048698965,
    -0.03419872,
    0.03052949,
    -0.006164456,
    -0.097922325,
    -0.038374577,
    -0.01782465,
    -0.052304357,
    0.09261609,
    -0.024518127,
    -0.0021367115,
    -0.040384635,
    -0.07860836,
    -0.00545785,
    -0.038318317,
    0.014918404,
    -0.028669447,
    0.029410677,
    0.017583394,
    0.017045312,
    -0.027161147,
    0.014646636,
    0.07401542,
    -0.024326682,
    0.0040630098,
    -0.003190702,
    0.04916388,
    0.011936331,
    0.0013716654,
    -0.031089583,
    -0.022604624,
    0.0010122507,
    0.06293429,
    0.001171219,
    0.001387067,
    0.0132260965,
    0.014272188,
    0.020303281,
    -0.032217424,
    0.026746528,
    -0.030174535,
    0.018689474,
    -0.011414082,
    -0.08627196,
    0.020774232,
    0.015734613,
    -0.008190765,
    0.016371246,
    -0.02637582,
    0.0580394,
    0.021313133,
    -0.024249775,
    0.0005284305,
    0.034690816,
    0.00036580098,
    0.0070989463,
    -0.041760143,
    -0.016574983,
    0.0019643323,
    -0.012445125,
    0.0011052502,
    0.07613174,
    -0.008717635,
    -0.01696545,
    0.018625028,
    0.03416461,
    0.01264552,
    -0.043470867,
    0.009575415,
    -0.01510751,
    0.061293524,
    -0.036190894,
    0.033066135,
    -0.014015215,
    0.021356361,
    -0.004524649,
    0.008296162,
    -0.012786313,
    0.01337254,
    -0.011232361,
    -0.00951955,
    0.027302727,
    0.085346185,
    0.020715414,
    0.034701627,
    0.015245445,
    0.04103619,
    0.020310448,
    -0.04006779,
    -0.00027463984,
    0.003733874,
    0.025080329,
    -0.072925024,
    -0.07670783,
    0.0014203744,
    0.040260945,
    -0.009916085,
    0.03144278,
    -0.021295864,
    0.016045546,
    0.0093771685,
    0.0037599576,
    0.019538099,
    0.005397788,
    -0.027158856,
    0.06262036,
    -0.0046395184,
    0.0006551302,
    0.0008448159,
    0.004861155,
    0.0068038977,
    -0.022853848,
    -0.0033746692,
    0.07797034,
    0.06358832,
    0.015729798,
    0.011027213,
    0.012160594,
    -0.03876204,
    0.0040416294,
    0.04770509,
    -0.026286812,
    -0.012038251,
    -0.014847368,
    -0.03817661,
    0.03181972,
    -0.008269945,
    0.015418283,
    0.036647946,
    0.045114655,
    0.032309342,
    0.017039364,
    -0.007836836,
    -0.02788196,
    0.012067525,
    -0.030199055,
    0.030796764,
    0.06491419,
    -0.03155334,
    0.0073259333,
    -0.004037303,
    -0.01695019,
    0.00524156,
    0.0034096611,
    0.040325828,
    -0.029742246,
    -0.042740576,
    0.0078001935,
    0.008585445,
    -0.0010140623,
    -0.022612866,
    -0.020762676,
    0.037843734,
    -0.032234784,
    0.087931156,
    -0.060167033,
    -0.040835716,
    -0.009065298,
    0.006692276,
    -0.029914198,
    0.06852809,
    0.057589162,
    -0.054293796,
    -0.009161796,
    -0.00027087884,
    0.05756115,
    0.0056635295,
    0.020331528,
    0.018711867,
    0.0120737795,
    0.003922082,
    0.04018996,
    0.0390693,
    -0.022280023,
    0.016338203,
    -0.041836705,
    -0.0060051903,
    0.025039194,
    0.032129813,
    -0.0023149033,
    -0.014507856,
    0.017803501,
    -0.0016074958,
    -0.05559914,
    -0.024692733,
    0.011179522,
    0.053857815,
    -0.0012063838,
    -0.039010316,
    -0.031566888,
    -0.013257185,
    0.056143206,
    0.028062731,
    -0.00065722235,
    0.017481232,
    0.04495275,
    0.018262707,
    -0.01831787,
    0.0267757,
    -0.004991226,
    0.004492403,
    -0.005600348,
    -0.039402265,
    -0.029869748,
    -0.03127527,
    0.014726288,
    0.0030718683,
    -0.0044588833,
    0.037114102,
    0.007164909,
    -0.04482232,
    0.041261323,
    -0.043888655,
    -0.051960755,
    0.022704039,
    0.0002246395,
    0.023429474,
    -0.037961356,
    -0.056298025,
    -0.03524882,
    0.010891387,
    -0.0026222705,
    0.021877436,
    0.02150814,
    0.0063864146,
    -0.03423115,
    -0.038206246,
    0.02299368,
    0.042288087,
    0.039516933,
    0.026607784,
    -0.0011702081,
    -0.018742796,
    0.055609908,
    0.02299601,
    -0.008145368,
    0.021089941,
    -0.026998516,
    0.015055928,
    0.010975604,
    -0.0036945199,
    -0.052992217,
    0.029383386,
    0.014640422,
    0.03957502,
    0.039082535,
    -0.034759995,
    -0.023580782,
    -0.02580762,
    0.0617074,
    -0.003992094,
    0.008986388,
    0.051666196,
    -0.0532419,
    -0.049018424,
    -0.044665147,
    0.016784439,
    0.082596175,
    0.0038174335,
    -0.0038756002,
    -0.028410807,
    0.045704413,
    -0.012852356,
    0.0054678502,
    0.0066704582,
    0.0089451745,
    0.09616751,
    -0.042246036,
    0.0033164283,
    0.025804702,
    0.03867982,
    -0.008371923,
    -0.0061260676,
    0.0799328,
    -0.049117353,
    0.041998666,
    0.0042058933,
    0.01380818,
    -0.02381298,
    -0.0473552,
    0.06365537,
    0.035934422,
    -0.055405784,
    -0.046455335,
    0.008549041,
    -0.013051704,
    -0.026864186,
    0.039780106,
    -0.019139308,
    -0.038360875,
    -0.016907798,
    0.056925762,
    -0.010154447,
    0.014534806,
    -0.003763512,
    -0.043208424,
    0.016244743,
    0.026183326,
    0.027411627,
    -0.019608026,
    0.01568597,
    0.0047957352,
    0.02907876,
    0.009358355,
    -0.0012100646,
    0.012391584,
    -0.017453762,
    -0.07614128,
    0.014382718,
    0.03464377,
    -0.0042171692,
    0.02812454,
    0.060675148,
    -0.018045433,
    0.028341115,
    -0.015468112,
    0.025630265,
    -0.036880534,
    0.017829861,
    -0.0069267224,
    -0.048571143,
    -0.016866,
    -0.0042660795,
    0.031871777,
    -0.0054197316,
    -0.010953795,
    0.052983824,
    -0.05528365,
    0.09973181,
    0.004090031,
    -0.0777213,
    -0.01614887,
    -0.0068795746,
    -0.02890479,
    -0.024904024,
    -0.026023071,
    -0.036464155,
    0.055552587,
    0.030221667,
    -0.08304856,
    0.014512057,
    -0.04215401,
    0.0060048276,
    -0.0016146617,
    -0.030005254,
    -0.022819426,
    0.008295326,
    -0.022117207,
    -0.00625417,
    0.010844785,
    0.023506014,
    0.029639553,
    -0.008441218,
    0.017969595,
    0.01588173,
    0.01572976,
    -0.0220022,
    -0.009870888,
    -0.011866245,
    0.05317959,
    -0.036552534,
    -0.04254379,
    0.01451719,
    -0.06128409,
    -0.010261855,
    0.011724197,
    0.0056334715,
    -0.058195993,
    -0.022329396,
    -0.040933568,
    -0.0050806645,
    -0.0037113698,
    -0.053071402,
    -0.005044357,
    0.09344349,
    0.00709586,
    0.0010976638,
    0.0047920365,
    0.007006124,
    -0.034818005,
    0.019297833,
    0.034389548,
    -0.00185197,
    -0.062039405,
    0.0008446145,
    0.026070645,
    0.058822367,
    -0.015754994,
    0.032906443,
    0.002014102,
    -0.0119807925,
    -0.047237355,
    -0.008128463,
    -0.06979626,
    0.027056733,
    0.046679594,
    0.008872028,
    0.049412657,
    -0.042005837,
    -0.05094287,
    -0.02015032,
    -0.039499752,
    -0.044963073,
    0.027285997,
    0.06895559,
    -0.04130689,
    -0.0018344882,
    0.074916475,
    -0.017851166,
    0.004579261,
    -0.06871477,
    -0.031456336,
    0.031813476,
    0.022785466,
    0.042122234,
    -0.054622564,
    -0.007862134,
    -0.0049736314,
    -0.030934442,
    0.03661903,
    -0.024299404,
    -0.00843642,
    0.02175965,
    -0.03817496,
    -0.01305917,
    -0.02085618,
    0.022823839,
    -0.059050817,
    0.043657027,
    -0.019397097,
    -0.042425077,
    0.013030398,
    0.023681257,
    0.02827538,
    0.034614034,
    -0.08210859,
    -0.0008878704,
    0.0004631202,
    -0.017150445,
    -0.03403509,
    0.047428925,
    0.0064243483,
    -0.049618933,
    -0.035544876,
    -0.019489886,
    -0.023985645,
    -0.060428057,
    -0.0027746602,
    -0.0611402,
    0.042436205,
    0.015346143,
    0.058255676,
    0.06593415,
    -0.0026336855,
    -0.00810304,
    0.0028706952,
    0.05819587,
    -0.007288149,
    0.02270012,
    0.017350769,
    0.034352332,
    -0.03260387,
    0.064923935,
    0.0804642,
    0.008004594,
    0.007654386,
    0.012986624,
    -0.0046803528,
    0.047958504,
    -0.026916947,
    -0.047560606,
    -0.0053076707,
    0.008217287,
    -0.018206464,
    0.01450956,
    -0.024399765,
    0.053327676,
    0.011826012,
    -0.014389495,
    -0.005574153,
    -0.056423955,
    -0.022628661,
    0.00995226,
    0.010182506,
    -0.055936936,
    -0.04002085,
    0.05708927,
    -0.042347446,
    0.028192585,
    0.02003523,
    -0.0084838215,
    -0.018642578,
    0.0018697388,
    -0.024843799,
    0.0043871603,
    -0.020815585,
    -0.026692906,
    -0.06827425,
    0.05379056,
    -0.034822796,
    -0.049783092,
    -0.0393624,
    -0.005888938,
    -0.047307376,
    -0.00920387,
    -0.02094657,
    -0.016456353,
    0.07489321,
    -0.00011571953,
    -0.033162728,
    -0.023310734,
    0.092428796,
    -0.01983948,
    0.022320589,
    0.012149401,
    0.021819089,
    -0.03366751,
    -0.059545003,
    0.015615293,
    0.02428235,
    0.0030444534,
    -0.053997293,
    -0.029356286,
    0.00791691,
    0.0018432747,
    0.063056305,
    -0.022730323,
    0.009024228,
    -0.014735888,
    -0.043062657,
    -0.014289999,
    0.030726701,
    0.06095054,
    -0.053185787,
    -0.052272737,
    0.050464597,
    0.04351335,
    -0.04574426,
    0.008692668,
    -0.040080756,
    0.04955572,
    -0.014583148,
    -0.004157669,
    -0.015885063,
    -0.029902449,
    0.022253443,
    0.008109295,
    0.05825521,
    -0.058368683,
    -0.019871758,
    -0.01049305,
    -0.036411215,
    -0.06864568,
    0.012564333,
    0.033983592,
    0.0049169967,
    0.0028815707,
    -0.027922431,
    -0.082635365,
    0.024880785,
    0.03992434,
    -0.02089682,
    0.058538634,
    -0.05431477,
    -0.023410283,
    0.0019861036,
    -0.010134206,
    0.01270941,
    0.030522628,
    0.010121369,
    0.12145492,
    0.013776092,
    0.027952928,
    0.0066632675,
    0.05039473,
    -0.017437601,
    -0.03020733,
    0.021604655,
    0.0014834116,
    -0.029853664
  ]
}