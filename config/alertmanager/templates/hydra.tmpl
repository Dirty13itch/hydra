{{ define "hydra.title" }}
[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}] {{ .CommonLabels.alertname }}
{{ end }}

{{ define "hydra.text" }}
{{ range .Alerts }}
*Alert:* {{ .Labels.alertname }}{{ if .Labels.severity }} - `{{ .Labels.severity }}`{{ end }}
*Node:* {{ .Labels.node | default "N/A" }}
*Status:* {{ .Status }}
{{ if .Annotations.summary }}*Summary:* {{ .Annotations.summary }}{{ end }}
{{ if .Annotations.description }}*Description:* {{ .Annotations.description }}{{ end }}
{{ if .Annotations.runbook_url }}*Runbook:* {{ .Annotations.runbook_url }}{{ end }}
*Started:* {{ .StartsAt.Format "2006-01-02 15:04:05 MST" }}
{{ if .EndsAt }}*Ended:* {{ .EndsAt.Format "2006-01-02 15:04:05 MST" }}{{ end }}
{{ end }}
{{ end }}

{{ define "hydra.discord" }}
{{ if eq .Status "firing" }}ðŸ”´{{ else }}ðŸŸ¢{{ end }} **{{ .CommonLabels.alertname }}**

{{ range .Alerts }}
**Status:** {{ .Status | title }}
**Severity:** {{ .Labels.severity | default "info" }}
**Node:** {{ .Labels.node | default "cluster" }}

{{ if .Annotations.summary }}{{ .Annotations.summary }}{{ end }}

{{ if .Annotations.description }}
> {{ .Annotations.description }}
{{ end }}

---
{{ end }}
{{ end }}

{{ define "hydra.slack" }}
{
  "attachments": [
    {{ range $i, $alert := .Alerts }}{{ if $i }},{{ end }}
    {
      "color": "{{ if eq $alert.Status "firing" }}{{ if eq $alert.Labels.severity "critical" }}#FF0000{{ else if eq $alert.Labels.severity "warning" }}#FFA500{{ else }}#0000FF{{ end }}{{ else }}#00FF00{{ end }}",
      "title": "{{ $alert.Labels.alertname }}",
      "text": "{{ $alert.Annotations.summary }}",
      "fields": [
        {
          "title": "Node",
          "value": "{{ $alert.Labels.node | default "N/A" }}",
          "short": true
        },
        {
          "title": "Severity",
          "value": "{{ $alert.Labels.severity | default "info" }}",
          "short": true
        }
      ],
      "footer": "Hydra Alertmanager",
      "ts": {{ $alert.StartsAt.Unix }}
    }
    {{ end }}
  ]
}
{{ end }}

{{ define "hydra.email.subject" }}
{{ if eq .Status "firing" }}[ALERT] {{ else }}[RESOLVED] {{ end }}{{ .CommonLabels.alertname }}{{ if .CommonLabels.node }} on {{ .CommonLabels.node }}{{ end }}
{{ end }}

{{ define "hydra.email.html" }}
<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .alert { padding: 15px; margin: 10px 0; border-radius: 5px; }
    .firing { background-color: #ffebee; border-left: 4px solid #f44336; }
    .resolved { background-color: #e8f5e9; border-left: 4px solid #4caf50; }
    .critical { border-left-color: #d32f2f; }
    .warning { border-left-color: #ff9800; }
    table { border-collapse: collapse; width: 100%; }
    th, td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
    th { background-color: #f5f5f5; }
  </style>
</head>
<body>
  <h2>Hydra Cluster Alert</h2>
  {{ range .Alerts }}
  <div class="alert {{ .Status }} {{ .Labels.severity }}">
    <h3>{{ .Labels.alertname }}</h3>
    <table>
      <tr><th>Status</th><td>{{ .Status | title }}</td></tr>
      <tr><th>Severity</th><td>{{ .Labels.severity | default "info" }}</td></tr>
      <tr><th>Node</th><td>{{ .Labels.node | default "N/A" }}</td></tr>
      {{ if .Annotations.summary }}<tr><th>Summary</th><td>{{ .Annotations.summary }}</td></tr>{{ end }}
      {{ if .Annotations.description }}<tr><th>Description</th><td>{{ .Annotations.description }}</td></tr>{{ end }}
      <tr><th>Started</th><td>{{ .StartsAt.Format "2006-01-02 15:04:05" }}</td></tr>
      {{ if eq .Status "resolved" }}<tr><th>Resolved</th><td>{{ .EndsAt.Format "2006-01-02 15:04:05" }}</td></tr>{{ end }}
    </table>
  </div>
  {{ end }}
  <p style="color: #666; font-size: 12px;">Sent by Hydra Alertmanager</p>
</body>
</html>
{{ end }}
